$(document).ready(function(){"use strict";$(".user-selection button").on("click",function(){var usernameInput=$("#username").val(),newUser={username:usernameInput};return console.log(newUser),$.ajax({url:"/users",type:"POST",dataType:"json",data:newUser,success:function(res,status){console.log("created new user: "+res.username+"with id: "+res._id),window.location.replace("users/"+res._id+"/")}}),!1}),$.get("username",function(username){$(".user-info .username").text(username)});var tabs=[];tabs.push($('<a href="#"><span class="tab" data-tab="1">Latest</span></a>')),tabs.push($('<a href="#"><span class="tab" data-tab="2">Oldest</span></a>')),tabs.push($('<a href="#"><span class="tab" data-tab="3">Tags</span></a>')),tabs.push($('<a href="#"><span class="tab" data-tab="4">Add</span></a>')),$(".tab-list").append(tabs),$(".tab-list a span").on("click",function(){$(".tab-list a span").removeClass("active"),$(this).addClass("active"),$(".tab-content").empty();var tabNumber=parseInt($(this).attr("data-tab"));switch(tabNumber){case 1:$.get("todos.json",function(todoList){for(var $content=$("<ul>"),i=todoList.length-1;i>=0;i--){var $li=$("<li>"),$input=$('<input type="checkbox" id="'+todoList[i]._id+'">'),$label=$('<label for="'+todoList[i]._id+'">'+todoList[i].description+"</label>");todoList[i].complete&&$input.attr("checked","checked"),$content.append($li,$input,$label)}$(".tab-content").html($content),$content.before("<label>Latest Todos:</label>")});break;case 2:$.get("todos.json",function(todoList){var $content=$("<ul>");todoList.forEach(function(todo){var $li=$("<li>"),$input=$('<input type="checkbox" id="'+todo._id+'">'),$label=$('<label for="'+todo._id+'">'+todo.description+"</label>");todo.complete&&$input.attr("checked","checked"),$content.append($li,$input,$label)}),$(".tab-content").html($content),$content.before("<label>Oldest Todos:</label>")});break;case 3:$.get("todos.json",function(todoList){var tagTodos=organizedByTags(todoList);tagTodos.forEach(function(tag){var $content=$("<div>");$content.append("<h3>"+tag.tag+"</h3>");var $todosList=$("<ul>");tag.descriptions.forEach(function(description){var $li=$("<li>"),$input=$('<input type="checkbox" id="'+description._id+'">'),$label=$('<label for="'+description._id+'">'+description.description+"</label>");description.complete&&$input.attr("checked","checked"),$li.append($input,$label),$todosList.append($li)}),$content.append($todosList),$(".tab-content").append($content)})});break;case 4:var $content=$('<form class="new-todo">'),$descriptionLabel=$('<label for="description">Description</label>'),$descriptionInput=$('<input type="text" id="description" placeholder="Cook dinner">'),$tagsLabel=$('<label for="tags">Tags</label>'),$tagsInput=$('<input type="text" id="tags" placeholder="Food, Chores, Cooking">'),$submitButton=$('<button class="primary-btn">Add Todo</button>');$content.append($descriptionLabel,$descriptionInput,$tagsLabel,$tagsInput,$submitButton),$(".tab-content").append($content),$submitButton.on("click",function(){var description=$("#description").val().trim(),tags=$("#tags").val().split(", "),newTodo={description:description,tags:tags};return $.post("todos",newTodo,function(res){console.log("we posted and the server responded: "+res),$(".tab-list a:first-child span").trigger("click")}),!1})}return!1});var organizedByTags=function(todoList){var tags=[];todoList.forEach(function(todo){todo.tags.forEach(function(tag){-1===tags.indexOf(tag)&&tags.push(tag)})});var tagDescriptions=tags.map(function(tag){var descriptions=[];return todoList.forEach(function(todo){-1!==todo.tags.indexOf(tag)&&descriptions.push({_id:todo._id,description:todo.description,complete:todo.complete})}),{tag:tag,descriptions:descriptions}});return tagDescriptions};$(".tab-list a:first-child span").trigger("click"),$(".tab-content").on("click","label",function(){console.log($(this).attr("for"));var id=$(this).attr("for");$.ajax({url:"todos/"+id,type:"PUT"}).done(function(res){console.log("updated todo complete status")}).fail(function(err){console.log(err)})}),$(".user-info button").on("click",function(){return $.ajax({url:"todos",type:"DELETE"}).done(function(res){console.log("all completed todos were cleared")}).fail(function(err){console.log(err)}),$(".tab-list a:first-child span").trigger("click"),!1})});